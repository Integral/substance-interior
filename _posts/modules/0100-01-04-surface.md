---
layout: module
title: Surface
abstract: A building block for web-based text editors.
author_twitter: _mql
author: Michael Aufreiter
links: # specify links for demo and source
  source: http://github.com/substance/surface
prose_link:
  http://prose.io/#substance/substance.github.com/edit/master/_posts/modules/0100-01-04-surface.md
version: not yet released
progress: 1
contributors:
- name: Victor Saiz
  user: vectorsize
  avatar: https://secure.gravatar.com/avatar/4f4b3e53c3cf88845ee48fc50ccf3593?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png
- name: Eugen Tudorancea
  user: navaru
  avatar: https://secure.gravatar.com/avatar/56bc79125f691c951f7036911f2c24d8?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png
- name: Tim Baumann
  user: timjb
  avatar: https://secure.gravatar.com/avatar/d6eea5713cdf2f25ebf001263fbaa9f4?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png
- name: Michael Aufreiter
  user: michael
  avatar: https://secure.gravatar.com/avatar/d5a959d7e57daa5433fcb9f8da40be4b?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png

categories:
- modules
published: true
---

Surface is intended to be an extensible low-level interface for semantic rich text editing. It doesn't introduce any UI components, but an API for managing user-defined text annotations.

# Try it out!

You can try the current version and see how it feels like beneath.

<iframe width="800" height="400" frameborder="0" scrolling="no" src="http://interior.substance.io/surface/">
</iframe>

# Usage

## Create a new Surface

    var surface = new Substance.Surface({
      el: $('.content')[0],
      content: $('script[name=content]').text(),
      types: {
        "em": { "inclusive": true },
        "str": { "inclusive": true },
        "idea": { "inclusive": false },
        "question": { "inclusive": false },
        "error": { "inclusive": false }
      }
    });
        
The types are optional, they denote which annotations the Surface supports. Annotations are created using the corresponding API calls.

## Text interact

### Return current content

Usage: `surface.content`

The content variable always holds the current content represented as a string.

### Insert text

Usage: `surface.insertText(text, index)

You can insert text programatically by calling `insertText` and passing in a `text` string as well as an `index` specifying the position where text will be inserted.

## Selections

### Get current selection

Usage: `surface.selection()`

As a return value, you'll get an array holding start position and offset (e.g. `[4, 5]` when the selection starts at character 4 and includes 5 characters).

### Set selection programmatically

Usage: `surface.select(start, end)`

Instead of selecting text by mouse or keyboard navigation, you can do it programatically by calling `select` and passing in `start` and `end` position of the selected characters.

## Annotations

### Get Annotations

Usage: `surface.annotations`

You can access currently registered annotations by examining the publicly exposed `surface.annotations` object.

The annotations object looks like this:

	{
      "annotation-1" : { id: "annotation-1", type: "idea", pos: [0,9] },
      "annotation-1" : { id: "annotation-2", type: "em", pos: [57,10] }
    }

### Insert annotation

Registering a new annotation is easy.

	`surface.insertAnnotation(annotation)`

### Delete annotation


### Highlight annotation

Usage: `surface.highlight`

Sometimes you want one annotation to stand out. You can do this by calling the `surface.highlight` method. Keep in mind this just adds a `.highlight` class to the corresponding characters. It's up to your stylesheet how a highlighted annotation differs from a regular one. 

## Events

### When selection changes

    surface.on('selection:changed', function(sel) {
      console.log('selected range', sel);
    });
    
### When content is updated

    surface.on('content:changed', function(content, prevContent) {
      console.log('updated text from', prevContent, 'to: ', content);
    });
    
    
# Notes

Surface is intentionally dumb. It doesn't do anything smart like detecting overlapping annotations etc. It doesn't even provide a UI for inserting annotations. That's by design since we realized it's very much application-specific how annotations are created and moved around.

For the Substance Composer we added some code to detect overlaps. While a character can be marked as strong and marked as `idea`, you can't combine strong and emphasized or idea and error.


